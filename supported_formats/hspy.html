

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>HSpy - HyperSpy’s HDF5 Specification &#8212; RosettaSciIO  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom-styles.css" />
    <link rel="icon" sizes="16x16" type="image/svg" href="../_static/logo_sq.svg" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'supported_formats/hspy';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Image formats" href="image.html" />
    <link rel="prev" title="EMPAD format (XML &amp; RAW)" href="empad.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo_rec_oct22.svg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo_rec_dark_oct22.svg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="index.html">
                        Supported formats
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../api/index.html">
                        API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../interoperability.html">
                        Interoperability
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../file_specification/index.html">
                        File Specifications
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../contributing.html">
                        Contributing
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../changes.html">
                        Changelog
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/hyperspy/rosettasciio" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://gitter.im/hyperspy/hyperspy" title="Gitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-gitter"></i></span>
            <label class="sr-only">Gitter</label></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="index.html">
                        Supported formats
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../api/index.html">
                        API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../interoperability.html">
                        Interoperability
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../file_specification/index.html">
                        File Specifications
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../contributing.html">
                        Contributing
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../changes.html">
                        Changelog
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/hyperspy/rosettasciio" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://gitter.im/hyperspy/hyperspy" title="Gitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-gitter"></i></span>
            <label class="sr-only">Gitter</label></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="blockfile.html">Blockfile</a></li>
<li class="toctree-l1"><a class="reference internal" href="bruker.html">Bruker</a></li>
<li class="toctree-l1"><a class="reference internal" href="de5.html">Direct Electron EMD (DE5)</a></li>
<li class="toctree-l1"><a class="reference internal" href="dens.html">DENSsolutions formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="digitalmicrograph.html">Gatan Digital Micrograph</a></li>
<li class="toctree-l1"><a class="reference internal" href="digitalsurf.html">DigitalSurf format (SUR &amp; PRO)</a></li>
<li class="toctree-l1"><a class="reference internal" href="edax.html">EDAX TEAM/Genesis (SPC, SPD)</a></li>
<li class="toctree-l1"><a class="reference internal" href="emd.html">Electron Microscopy Dataset (EMD)</a></li>
<li class="toctree-l1"><a class="reference internal" href="empad.html">EMPAD format (XML &amp; RAW)</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">HSpy - HyperSpy’s HDF5 Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="image.html">Image formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="jeol.html">JEOL Analyst Station (ASW, …)</a></li>
<li class="toctree-l1"><a class="reference internal" href="jobinyvon.html">Horiba Jobin Yvon LabSpec</a></li>
<li class="toctree-l1"><a class="reference internal" href="mrc.html">MRC format</a></li>
<li class="toctree-l1"><a class="reference internal" href="mrcz.html">MRCZ format</a></li>
<li class="toctree-l1"><a class="reference internal" href="msa.html">EMSA/MSA format</a></li>
<li class="toctree-l1"><a class="reference internal" href="netcdf.html">NetCDF (EELSlab) format</a></li>
<li class="toctree-l1"><a class="reference internal" href="nexus.html">NeXus data format</a></li>
<li class="toctree-l1"><a class="reference internal" href="pantarhei.html">CEOS Panta Rhei (PRZ)</a></li>
<li class="toctree-l1"><a class="reference internal" href="phenom.html">Phenom ELID format</a></li>
<li class="toctree-l1"><a class="reference internal" href="protochips.html">Protochips logfile</a></li>
<li class="toctree-l1"><a class="reference internal" href="ripple.html">Ripple format</a></li>
<li class="toctree-l1"><a class="reference internal" href="semper.html">SEMPER binary format (UNF)</a></li>
<li class="toctree-l1"><a class="reference internal" href="tia.html">FEI TIA (SER &amp; EMI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="tiff.html">Tagged image file format (TIFF)</a></li>
<li class="toctree-l1"><a class="reference internal" href="trivista.html">TriVista</a></li>
<li class="toctree-l1"><a class="reference internal" href="tvips.html">TVIPS format</a></li>
<li class="toctree-l1"><a class="reference internal" href="usid.html">Universal Spectroscopy and Imaging Data (h5USID)</a></li>
<li class="toctree-l1"><a class="reference internal" href="zspy.html">ZSpy - HyperSpy’s Zarr Specification</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Supported formats</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">HSpy - HyperSpy’s HDF5 Specification</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="hspy-hyperspy-s-hdf5-specification">
<span id="hspy-format"></span><h1>HSpy - HyperSpy’s HDF5 Specification<a class="headerlink" href="#hspy-hyperspy-s-hdf5-specification" title="Permalink to this heading">#</a></h1>
<p>This is <a class="reference external" href="https://hyperspy.org">HyperSpy’s</a> default format and for data processed
in HyperSpy, it is the only format that guarantees that no
information will be lost in the writing process and that supports saving data
of arbitrary dimensions. It is based on the <a class="reference external" href="https://www.hdfgroup.org/solutions/hdf5/">HDF5 open standard</a>. The HDF5 file format is supported by <a class="reference external" href="https://support.hdfgroup.org/products/hdf5_tools/SWSummarybyName.htm">many
applications</a>.
Parts of the specifications are documented in <a class="reference external" href="https://hyperspy.org/hyperspy-doc/current/user_guide/metadata_structure.html#metadata-structure" title="(in HyperSpy v1.7.4)"><span>Metadata structure</span></a>.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version HyperSpy_v1.2: </span>Enable saving HSpy files with the <code class="docutils literal notranslate"><span class="pre">.hspy</span></code> extension. Previously only the
<code class="docutils literal notranslate"><span class="pre">.hdf5</span></code> extension was recognised.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version HyperSpy_v1.3: </span>The default extension for the HyperSpy HDF5 specification is now <code class="docutils literal notranslate"><span class="pre">.hspy</span></code>.
The option to change the default is no longer present in <code class="docutils literal notranslate"><span class="pre">preferences</span></code>.</p>
</div>
<p>Only loading of HDF5 files following the HyperSpy specifications is supported by
this plugin. Usually their extension is <code class="docutils literal notranslate"><span class="pre">.hspy</span></code> extension, but older versions of
HyperSpy would save them with the <code class="docutils literal notranslate"><span class="pre">.hdf5</span></code> extension. Both extensions are
recognised by HyperSpy since version 1.2. However, HyperSpy versions older than 1.2
won’t recognise the <code class="docutils literal notranslate"><span class="pre">.hspy</span></code> extension. To work around the issue when using old
HyperSpy installations simply change the extension manually to <code class="docutils literal notranslate"><span class="pre">.hdf5</span></code> or
directly save the file using this extension by explicitly adding it to the
filename e.g.:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">hyperspy.api</span> <span class="k">as</span> <span class="nn">hs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">BaseSignal</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;test.hdf5&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>When saving to <code class="docutils literal notranslate"><span class="pre">.hspy</span></code>, all supported objects in the signal’s
<a class="reference external" href="https://hyperspy.org/hyperspy-doc/current/api/hyperspy.signal.html#hyperspy.signal.BaseSignal.metadata" title="(in HyperSpy v1.7.4)"><code class="xref py py-attr docutils literal notranslate"><span class="pre">hyperspy.signal.BaseSignal.metadata</span></code></a> are stored. This includes lists, tuples
and signals. Please note that in order to increase saving efficiency and speed,
if possible, the inner-most structures are converted to numpy arrays when saved.
This procedure homogenizes any types of the objects inside, most notably casting
numbers as strings if any other strings are present:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># before saving:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">somelist</span>
<span class="go">[1, 2.0, &#39;a name&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># after saving:</span>
<span class="go">[&#39;1&#39;, &#39;2.0&#39;, &#39;a name&#39;]</span>
</pre></div>
</div>
<p>The change of type is done using numpy “safe” rules, so no information is lost,
as numbers are represented to full machine precision.</p>
<p>This feature is particularly useful when using
<a class="reference external" href="https://hyperspy.org/hyperspy-doc/current/api/hyperspy._signals.eds.html#hyperspy._signals.eds.EDSSpectrum.get_lines_intensity" title="(in HyperSpy v1.7.4)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">hyperspy._signals.eds.EDSSpectrum.get_lines_intensity()</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">example_signals</span><span class="o">.</span><span class="n">EDS_SEM_Spectrum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">Sample</span><span class="o">.</span><span class="n">intensities</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">get_lines_intensity</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;EDS_spectrum.hspy&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s_new</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;EDS_spectrum.hspy&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_new</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">Sample</span><span class="o">.</span><span class="n">intensities</span>
<span class="go">[&lt;BaseSignal, title: X-ray line intensity of EDS SEM Signal1D: Al_Ka at 1.49 keV, dimensions: (|)&gt;,</span>
<span class="go"> &lt;BaseSignal, title: X-ray line intensity of EDS SEM Signal1D: C_Ka at 0.28 keV, dimensions: (|)&gt;,</span>
<span class="go"> &lt;BaseSignal, title: X-ray line intensity of EDS SEM Signal1D: Cu_La at 0.93 keV, dimensions: (|)&gt;,</span>
<span class="go"> &lt;BaseSignal, title: X-ray line intensity of EDS SEM Signal1D: Mn_La at 0.63 keV, dimensions: (|)&gt;,</span>
<span class="go"> &lt;BaseSignal, title: X-ray line intensity of EDS SEM Signal1D: Zr_La at 2.04 keV, dimensions: (|)&gt;]</span>
</pre></div>
</div>
<section id="chunking">
<span id="hspy-chunks"></span><h2>Chunking<a class="headerlink" href="#chunking" title="Permalink to this heading">#</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">New in version HyperSpy_v1.3.1: </span><code class="docutils literal notranslate"><span class="pre">chunks</span></code> keyword argument</p>
</div>
<p>The HyperSpy HDF5 format supports chunking the data into smaller pieces to make it possible to load only part
of a dataset at a time. By default, the data is saved in chunks that are optimised to contain at least one
full signal.  It is possible to
customise the chunk shape using the <code class="docutils literal notranslate"><span class="pre">chunks</span></code> keyword.
For example, to save the data with <code class="docutils literal notranslate"><span class="pre">(20,</span> <span class="pre">20,</span> <span class="pre">256)</span></code> chunks instead of the default <code class="docutils literal notranslate"><span class="pre">(7,</span> <span class="pre">7,</span> <span class="pre">2048)</span></code> chunks
for this signal:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2048</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;test_chunks&quot;</span><span class="p">,</span> <span class="n">chunks</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">256</span><span class="p">))</span>
</pre></div>
</div>
<p>Note that currently it is not possible to pass different customised chunk shapes to all signals and
arrays contained in a signal and its metadata. Therefore, the value of <code class="docutils literal notranslate"><span class="pre">chunks</span></code> provided on saving
will be applied to all arrays contained in the signal.</p>
<p>By passing <code class="docutils literal notranslate"><span class="pre">True</span></code> to <code class="docutils literal notranslate"><span class="pre">chunks</span></code> the chunk shape is guessed using the <code class="docutils literal notranslate"><span class="pre">guess_chunk</span></code> function of <code class="docutils literal notranslate"><span class="pre">h5py</span></code>
For large signal spaces, the autochunking usually leads to smaller chunks as <code class="docutils literal notranslate"><span class="pre">guess_chunk</span></code> does not impose the
constrain of storing at least one signal per chunk. For example, for the signal in the example above
passing <code class="docutils literal notranslate"><span class="pre">chunks=True</span></code> results in chunks of <code class="docutils literal notranslate"><span class="pre">(7,</span> <span class="pre">7,</span> <span class="pre">256)</span></code>.</p>
<p>Choosing the correct chunk-size can significantly affect the speed of reading,
writing and performance of many HyperSpy algorithms. See the
<a class="reference external" href="https://hyperspy.org/hyperspy-doc/current/user_guide/big_data.html#big-data-chunking" title="(in HyperSpy v1.7.4)"><span class="xref std std-ref">HyperSpy chunking section</span></a> for more information.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Also see the <a class="reference internal" href="../api/utils.html#hdf5-utils"><span class="std std-ref">HDF5 utility functions</span></a> for inspecting HDF5 files.</p>
</div>
</section>
<section id="module-rsciio.hspy">
<span id="api-functions"></span><h2>API functions<a class="headerlink" href="#module-rsciio.hspy" title="Permalink to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="rsciio.hspy.file_reader">
<span class="sig-prename descclassname"><span class="pre">rsciio.hspy.</span></span><span class="sig-name descname"><span class="pre">file_reader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lazy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rsciio.hspy.file_reader" title="Permalink to this definition">#</a></dt>
<dd><p>Read data from hdf5-files saved with the HyperSpy hdf5-format
specification (<code class="docutils literal notranslate"><span class="pre">.hspy</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em><em>, </em><em>pathlib.Path</em>) – Filename of the file to read or corresponding <cite>pathlib.Path</cite>.</p></li>
<li><p><strong>lazy</strong> (<em>bool</em><em>, </em><em>Default=False</em>) – Whether to open the file lazily or not.</p></li>
<li><p><strong>**kwds</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>List of dictionaries containing the following fields:</p>
<ul class="simple">
<li><p>’data’ – multidimensional numpy array</p></li>
<li><p>’axes’ – list of dictionaries describing the axes
containing the fields ‘name’, ‘units’, ‘index_in_array’, and
either ‘size’, ‘offset’, and ‘scale’ or a numpy array ‘axis’
containing the full axes vector</p></li>
<li><p>’metadata’ – dictionary containing the parsed metadata</p></li>
<li><p>’original_metadata’ – dictionary containing the full metadata tree from the input file</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of dicts</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rsciio.hspy.file_writer">
<span class="sig-prename descclassname"><span class="pre">rsciio.hspy.</span></span><span class="sig-name descname"><span class="pre">file_writer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">close_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rsciio.hspy.file_writer" title="Permalink to this definition">#</a></dt>
<dd><p>Writes data to HyperSpy’s hdf5-format (<code class="docutils literal notranslate"><span class="pre">.hspy</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em><em>, </em><em>pathlib.Path</em>) – Filename of the file to write to or corresponding <cite>pathlib.Path</cite>.</p></li>
<li><p><strong>signal</strong> (<em>dict</em>) – <p>Dictionary containing the signal object.
Should contain the following fields:</p>
<ul>
<li><p>’data’ – multidimensional numpy array</p></li>
<li><p>’axes’ – list of dictionaries describing the axes
containing the fields ‘name’, ‘units’, ‘index_in_array’, and
either ‘size’, ‘offset’, and ‘scale’ or a numpy array ‘axis’
containing the full axes vector</p></li>
<li><p>’metadata’ – dictionary containing the metadata tree</p></li>
</ul>
</p></li>
<li><p><strong>compression</strong> (<em>None</em><em>, </em><em>'gzip'</em><em>, </em><em>'szip'</em><em>, </em><em>'lzf'</em><em>, </em><em>Default='gzip'.</em>) – Compression can significantly increase the saving speed. If file size is not
an issue, it can be disabled by setting <code class="docutils literal notranslate"><span class="pre">compression=None</span></code>.
RosettaSciIO uses h5py for reading and writing HDF5 files and, therefore,
it supports all <a class="reference external" href="https://docs.h5py.org/en/stable/high/dataset.html#dataset-compression">compression filters supported by h5py</a>.
The default is <code class="docutils literal notranslate"><span class="pre">'gzip'</span></code>. Also see notes below.</p></li>
<li><p><strong>chunks</strong> (<em>tuple</em><em> of </em><em>integer</em><em> or </em><em>None</em><em>, </em><em>Default=None</em>) – Define the chunking used for saving the dataset. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, calculates
chunks for the signal, with preferably at least one chunk per signal
space.</p></li>
<li><p><strong>close_file</strong> (<em>bool</em><em>, </em><em>Default=True</em>) – Close the file after writing.  The file should not be closed if the data
needs to be accessed lazily after saving.</p></li>
<li><p><strong>write_dataset</strong> (<em>bool</em><em>, </em><em>Default=True</em>) – If True, write the dataset, otherwise, don’t write it. Useful to
overwrite attributes (for example <code class="docutils literal notranslate"><span class="pre">axes_manager</span></code>) only without having
to write the whole dataset.</p></li>
<li><p><strong>**kwds</strong> – The keyword argument are passed to the
<a class="reference external" href="https://docs.h5py.org/en/stable/high/group.html#h5py.Group.require_dataset" title="(in h5py v3.8)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">h5py.Group.require_dataset()</span></code></a> function.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>It is possible to enable other compression filters such as <code class="docutils literal notranslate"><span class="pre">blosc</span></code> by
installing e.g. <a class="reference external" href="https://github.com/silx-kit/hdf5plugin">hdf5plugin</a>.
Similarly, the availability of <code class="docutils literal notranslate"><span class="pre">'szip'</span></code> depends on the HDF5 installation.
If not available an error will be raised. Be aware that loading those
files will require installing the package providing the compression filter
and it may thus not be possible to load it on some platforms.
Only <code class="docutils literal notranslate"><span class="pre">compression=None</span></code> and <code class="docutils literal notranslate"><span class="pre">compression='gzip'</span></code> are available on all
platforms. For more details, see the <a class="reference external" href="https://docs.h5py.org/en/stable/faq.html#what-compression-processing-filters-are-supported">h5py documentation</a>.</p>
</dd></dl>

</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="empad.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">EMPAD format (XML &amp; RAW)</p>
      </div>
    </a>
    <a class="right-next"
       href="image.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Image formats</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chunking">Chunking</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-rsciio.hspy">API functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rsciio.hspy.file_reader"><code class="docutils literal notranslate"><span class="pre">file_reader()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rsciio.hspy.file_writer"><code class="docutils literal notranslate"><span class="pre">file_writer()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div class="tocsection sourcelink">
    <a href="../_sources/supported_formats/hspy.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2022, HyperSpy Developers.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    <br/>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>